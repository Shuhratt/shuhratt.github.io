<!--Посмотрите код страницы и вывод в консоль браузера.-->

<script src="shri-async-hw.js"></script>
<script>
    const {
        AsyncArray,
        add,
        subtract,
        multiply,
        divide,
        mod,
        less,
        equal,
        lessOrEqual,
        sqrt
    } = Homework;

    function square(a,b,c, cb) {
        if(!Number.isInteger(a) || !Number.isInteger(b) || !Number.isInteger(c) ) {
            console.error('Не числовые аргументы')
            return
        }

        const as = new AsyncArray();

        const asyncAddArgument = (arg) => {
            let maxTime = 10000 // максимальное время ожидания
            return new Promise((resolve, reject) => {
                as.push(arg, () => resolve(arg))
                setTimeout(() => {
                    reject(arg)
                }, maxTime)
            })
        }

        let argA = asyncAddArgument(a)
        let argB = asyncAddArgument(b)
        let argC = asyncAddArgument(c)



        /*
            D = b^2 – 4ac ;
            если   D < 0 ,   то квадратное уравнение не имеет корней ;
            если   D = 0 ,   то квадратное уравнение имеет один корень   x = –b 2a;
            если   D > 0 ,   то квадратное уравнение имеет два корня


            x1 = –b + √ D / 2a
            x2 = –b − √ D / 2a

         */
        //Promise.allSettled([promise1, promise2])
        // возвращает промис, который исполняется когда все полученные промисы завершены (исполнены или отклонены)


    const argAll = Promise.all([argA, argB, argC])
        .then(([a, b, c]) => { // all arguments

            // подготовка значений для D
            let firstMember = new Promise(((resolve, reject) => multiply(b, b, (res) => resolve(res))))
            let secondMember = new Promise(((resolve, reject) => multiply(a, c, (res) => resolve(res))))
                                    .then(value => new Promise(((resolve, reject) => multiply(value, 4, (res) => resolve(res)))));


            Promise.all([firstMember, secondMember])
            .then(([f, s]) => console.log(f - s))


        })
                    // .then(([a,b,c]) => {
                    //
                    // })
                    .catch(err => console.error(err))








        // let d = (parseInt(a) * 2) - (4 * parseInt(a) * parseInt(c))
    }

    square(1,2,4, (x1, x2) => {
        console.log(`x1 = ${x1}, x2 = ${x2}`)
    })


    // const {
    //     AsyncArray,
    //     add,
    //     subtract,
    //     multiply,
    //     divide,
    //     mod,
    //     less,
    //     equal,
    //     lessOrEqual,
    //     sqrt
    // } = Homework;
    //
    // const a = new AsyncArray([1, 2, 3]);
    //
    // console.log('добавление элемента');
    // a.push(4, () => { 
    //     console.log('добавление элемента выполнено');
    //     a.print();
    // });
    // a.print();
    //
    // console.log('присваивание элемента по индексу');
    // a.set(2, 999, () => { 
    //     console.log('присваивание элемента по индексу выполнено');
    //     a.print();
    // });
    // a.print();
    //
    // console.log('получение элемента по индексу');
    // a.get(0, (result) => { 
    //     console.log('получение элемента по индексу выполнено');
    //     console.log('результат', result);
    //     a.print();
    // });
    // a.print();
    //
    // console.log('получение последнего элемента');
    // a.pop((result) => { 
    //     console.log('получение последнего элемента выполнено');
    //     console.log('результат', result);
    //     a.print();
    // });
    // a.print();
    //
    // console.log('получение длины массива');
    // a.length((result) => { 
    //     console.log('получение длины массива выполнено');
    //     console.log('результат', result);
    //     a.print();
    // });
    // a.print();
    //
    // console.log('сложение: 5 + 2');
    // add(5, 2, (result) => console.log('результат сложения', result));
    //
    // console.log('вычитание: 11 - 7');
    // subtract(11, 7, (result) => console.log('результат вычитания', result));
    //
    // console.log('умножение: 6 * 7');
    // multiply(6, 7, (result) => console.log('результат умножения', result));
    //
    // console.log('деление: 13 / 7');
    // divide(13, 7, (result) => console.log('результат деления', result));
    //
    // console.log('остаток от деления: 17 % 7');
    // mod(17, 7, (result) => console.log('получен остаток от деления', result));
    //
    // console.log('квадратный корень из 16');
    // sqrt(16, (result) => console.log('квадратный корень', result));
    //
    // console.log('операция МЕНЬШЕ: 5 < 3');
    // less(5, 3, (result) => console.log('результат операции МЕНЬШЕ', result));
    //
    // console.log('операция РАВНО: 1 == 1');
    // equal(1, 1, (result) => console.log('результат операции РАВНО', result));
    //
    // console.log('операция МЕНЬШЕ ИЛИ РАВНО: 12 <= 19');
    // lessOrEqual(12, 19, (result) => console.log('результат операции МЕНЬШЕ ИЛИ РАВНО', result));

</script>
